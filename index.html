<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layer-1 Technologies - Project Proposal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Google Material Symbols -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        .cover-bg {
            background-color: #000000;
            background-size: cover;
            background-position: center;
            color: white;
        }
        /* Ensure text on the cover is always white */
        .cover-bg h1, .cover-bg h2, .cover-bg p {
             color: white !important;
        }
        .assistant-header {
             color: white !important;
        }
        
        /* Spacing for screen view */
        @media screen {
            .proposal-body section:not(:last-child) {
                margin-bottom: 3rem;
            }
        }

        /* Print-specific styles */
        @media print {
            .no-print {
                display: none !important;
            }
            html, body {
                margin: 0 !important;
                padding: 0 !important;
                width: 100%;
                height: 100%;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                background: white !important;
            }
            .print-full-bleed {
                max-width: none !important;
                margin: 0 !important;
                box-shadow: none !important;
                background-color: transparent !important;
            }
            /* Push each section to a new page when printing */
            .proposal-body section {
                page-break-before: always;
                padding-top: 0.25in; 
            }
            /* The first section (TOC) doesn't need a break before it */
            .proposal-body section:first-of-type {
                page-break-before: avoid;
            }
            .cover-bg {
                height: 100vh; /* Force cover to be exactly one page high */
                page-break-after: always; /* Ensure content after it starts on a new page */
                background-color: #000000 !important;
            }
            
            /* --- FINAL PRINT-SPECIFIC FIXES --- */
            
            /* Prevent sections from breaking across pages */
            .print-section-container {
                page-break-inside: avoid !important;
            }

            /* Force desktop grid layouts to override mobile stacking */
            #why-us .grid,
            #insurance .grid,
            #acceptance .grid {
                 display: grid !important;
                 grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
                 gap: 1.5rem !important;
            }
            
            /* Ensure alignment is correct for specific sections */
            #insurance .text-center {
                text-align: center !important;
            }
            #testimonials .text-right {
                text-align: right !important;
            }

            /* Double the font size for TOC items */
            #table-of-contents li a {
                font-size: 2rem !important;
                line-height: 2.5rem !important;
            }
            
            /* --- END OF FIXES --- */

            /* Define the footer area and page margins for paged media */
            @page {
                size: letter;
                margin: 0.5in;
                @bottom-center {
                    content: "Page " counter(page) " of " counter(pages);
                    font-family: 'Poppins', sans-serif;
                    font-size: 9px;
                    color: #6b7280;
                    padding-bottom: 0.1in;
                    vertical-align: top;
                }
            }

            /* Special rule for the first page (cover) */
            @page :first {
                margin: 0 !important; /* No margin for the cover page */
                @bottom-center {
                    content: "" !important; /* No footer content on the first page */
                }
            }
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Gemini API Proposal Assistant (This section will not be printed) -->
    <div class="no-print max-w-4xl mx-auto my-8 p-6 bg-gray-800 text-white rounded-lg shadow-2xl">
        <h2 class="text-2xl font-bold mb-4 border-b border-[#0b5394] pb-2 assistant-header">✨ Proposal Assistant (For Internal Use)</h2>
        <p class="mb-6 text-gray-300">Fill out the fields below, then use the buttons to generate and finalize your proposal.</p>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6 mb-4">
            <!-- Input fields are grouped for easier management by JS -->
            <div data-input-group>
                <label for="projectName" class="block text-xl font-medium text-gray-300 text-center">Project Name</label>
                <input type="text" id="projectName" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]">
            </div>
             <div>
                <label for="estimateNumber" class="block text-xl font-medium text-gray-300 text-center">QuickBooks Estimate #</label>
                <input type="text" id="estimateNumber" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]">
            </div>
             <div>
                <label for="clientCompany" class="block text-xl font-medium text-gray-300 text-center">Client Company Name</label>
                <input type="text" id="clientCompany" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]">
            </div>
             <div>
                <label for="clientContact" class="block text-xl font-medium text-gray-300 text-center">Client Contact Name</label>
                <input type="text" id="clientContact" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]">
            </div>
             <div>
                <label for="clientEmail" class="block text-xl font-medium text-gray-300 text-center">Client Email Address</label>
                <input type="email" id="clientEmail" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]">
            </div>
            <div>
                <label for="investmentAmount" class="block text-xl font-medium text-gray-300 text-center">Total Project Investment</label>
                <input type="text" id="investmentAmount" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]" placeholder="e.g., 15,250.00">
            </div>
            <div class="md:col-span-2">
                <label for="estimateUrl" class="block text-xl font-medium text-gray-300 text-center">QuickBooks Estimate URL</label>
                <input type="url" id="estimateUrl" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]" placeholder="https://qbo.intuit.com/...">
            </div>
        </div>

        <div>
            <label for="projectNotes" class="block text-xl font-medium text-gray-300 text-center">Your Project Notes for AI</label>
            <textarea id="projectNotes" rows="6" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-[#0b5394] focus:border-[#0b5394]" placeholder="e.g., Install 20 Cat6 drops, setup 3 conference rooms with Polycom systems..."></textarea>
        </div>

        <div class="space-y-4 mt-6">
            <button id="populateBtn" class="w-full bg-[#0b5394] hover:bg-[#094275] text-white font-bold py-2 px-4 rounded-lg transition-colors">Analyze & Populate Proposal</button>
            <button id="sampleDataBtn" class="w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">Fill with Sample Data (Testing)</button>
        </div>
        
        <div class="border-t border-gray-600 mt-6 pt-4">
            <button id="finalizeBtn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">Finalize & Export as PDF</button>
        </div>
    </div>


    <div class="max-w-4xl mx-auto bg-white shadow-2xl print-full-bleed">
        <!-- Cover Page -->
        <div class="cover-bg relative text-white min-h-screen flex flex-col items-center justify-center p-8 text-center">
            <div class="bg-black bg-opacity-50 p-10 rounded-lg">
                <img src="https://www.layer-1.com/wp-content/uploads/2025/06/Layer-1-Logo-_-Black-_-300-x-300.png" alt="Layer-1 Technologies Logo" class="mx-auto h-96 w-96 mb-6" onerror="this.style.display='none'">
                <h1 class="text-6xl font-thin tracking-tight">LAYER-1 TECHNOLOGIES</h1>
                <p class="text-2xl mt-4 font-light">Project Proposal</p>
                <div class="my-12 border-t-2 border-[#0b5394] w-1/4 mx-auto"></div>
                <h2 data-display="projectName" class="text-4xl font-semibold">[PROJECT NAME]</h2>
                <p class="text-xl mt-4">Prepared for: <span data-display="clientCompany">[CLIENT NAME]</span></p>
                <div class="mt-8 text-lg space-y-2">
                    <p>Date: <time data-display="date" class="font-semibold">[DATE]</time></p>
                    <p>Proposal Number: <span data-display="estimateNumber" class="font-semibold">[PROPOSAL NUMBER]</span></p>
                </div>
            </div>
            <div class="absolute bottom-8 text-center w-full text-white">
                <p class="text-sm">500 East 4th Street, #254, Austin, TX 78701 | (844) 229-2783 | <a href="https://www.Layer-1.com" target="_blank" class="text-[#a8c7fa] hover:text-white">Layer-1.com</a></p>
            </div>
        </div>

        <!-- Proposal Body -->
        <div class="p-8 md:p-12 proposal-body text-gray-800">
            
            <!-- Table of Contents -->
            <section id="table-of-contents" class="print-section-container">
                <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Table of Contents</h2>
                <ul class="list-disc list-inside space-y-3 text-xl">
                    <li><a href="#why-us" class="text-[#0b5394] hover:underline">Why Choose Layer-1 Technologies?</a></li>
                    <li><a href="#testimonials" class="text-[#0b5394] hover:underline">What Our Clients Say</a></li>
                    <li><a href="#insurance" class="text-[#0b5394] hover:underline">Insurance</a></li>
                    <li><a href="#project-overview" class="text-[#0b5394] hover:underline">Project Overview</a></li>
                    <li><a href="#scope-of-work" class="text-[#0b5394] hover:underline">Scope of Work</a></li>
                    <li><a href="#project-estimate" class="text-[#0b5394] hover:underline">Investment</a></li>
                    <li><a href="#terms-of-acceptance" class="text-[#0b5394] hover:underline">Terms of Acceptance</a></li>
                    <li><a href="#acceptance" class="text-[#0b5394] hover:underline">Acceptance of Proposal</a></li>
                </ul>
            </section>
            
            <!-- Static Content Sections -->
            <section id="why-us" class="print-section-container">
                <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Why Choose Layer-1 Technologies?</h2>
                <div class="text-gray-800 space-y-8">
                    <p>Layer-1 Technologies is the trusted partner for designing and implementing mission-critical <strong>Technology Infrastructure</strong>, built upon a foundation of over 25 years of leadership experience in the field. We provide a holistic approach to your low-voltage needs, from foundational structured cabling to integrated audio/visual, security camera, and door access control systems. Our commitment is to build a reliable, scalable, and secure technological backbone that empowers your organization to thrive.</p>
                    <div class="grid md:grid-cols-2 gap-8 mb-8">
                        <div class="bg-[#e7f0fa] p-6 rounded-lg hover:shadow-lg transition-shadow"><h3 class="font-bold text-xl mb-2 text-[#0b5394]">BICSI Certified Expertise</h3><p class="text-sm text-gray-800">Our team is <strong>BICSI certified</strong>, representing the gold standard in the information and communications technology industry. This certification is your assurance that every project is meticulously planned and executed according to the most stringent standards for quality, safety, and performance. It's not just about getting the job done; it's about getting it done right the first time.</p></div>
                        <div class="bg-[#e7f0fa] p-6 rounded-lg hover:shadow-lg transition-shadow"><h3 class="font-bold text-xl mb-2 text-[#0b5394]">Proven Across Industries</h3><p class="text-sm text-gray-800">We have earned the trust of clients in the world's most demanding sectors, including global banking, healthcare, aerospace, advanced robotics, and insurance. Our experience in these high-stakes environments proves our ability to deliver robust and resilient infrastructure where security, reliability, and precision are non-negotiable.</p></div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-[#e7f0fa] p-6 rounded-lg hover:shadow-lg transition-shadow"><h3 class="font-bold text-xl mb-2 text-[#0b5394]">Commitment to Quality</h3><p class="text-sm text-gray-800">We use only high-grade materials and employ experienced, skilled tradespeople to ensure every detail of your project is executed to the highest standard.</p></div>
                        <div class="bg-[#e7f0fa] p-6 rounded-lg hover:shadow-lg transition-shadow"><h3 class="font-bold text-xl mb-2 text-[#0b5394]">Transparent Communication</h3><p class="text-sm text-gray-800">You will receive regular updates from a dedicated project manager. We believe in clear, proactive communication to ensure you are always informed.</p></div>
                        <div class="bg-[#e7f0fa] p-6 rounded-lg hover:shadow-lg transition-shadow"><h3 class="font-bold text-xl mb-2 text-[#0b5394]">On Time & On Budget</h3><p class="text-sm text-gray-800">We pride ourselves on efficient project management to deliver a project as quoted and within the agreed-upon timeline. No surprises.</p></div>
                        <div class="bg-[#e7f0fa] p-6 rounded-lg hover:shadow-lg transition-shadow"><h3 class="font-bold text-xl mb-2 text-[#0b5394]">Safety First</h3><p class="text-sm text-gray-800">We maintain a rigorous safety program to protect our crew, our clients, and their property throughout the construction process.</p></div>
                    </div>
                </div>
            </section>
            <section id="testimonials" class="print-section-container">
                <div class="mb-6"><h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2">What Our Clients Say</h2><p class="text-[10px] text-gray-500 mt-1 italic">Additional references and a comprehensive list of testimonials are available upon request.</p></div>
                <div class="space-y-12">
                    <div class="bg-[#e7f0fa] p-6 rounded-lg border-l-4 border-gray-200"><p class="text-sm text-gray-800 italic">"Layer-1 Technologies has been an absolute pleasure to work with over the years. Their team is incredibly knowledgeable, professional, and always goes above and beyond... I always know that when Layer-1 is on the job, everything will be done to the highest standard... They have been a trusted partner since 2014, and I can't recommend them highly enough!"</p><p class="text-right font-semibold text-gray-800 mt-4">- Sandy Roy, Director of Operations<br><span class="font-normal text-sm">Kuper Sotheby’s International Realty</span></p></div>
                    <div class="bg-[#e7f0fa] p-6 rounded-lg border-l-4 border-gray-200"><p class="text-sm text-gray-800 italic">“Layer-1 Technologies has expertly managed a wide range of our technology needs—from ground-up network & structured cabling and audio/video installs at our Austin HQ to large-scale rewiring projects and nationwide pharmacy expansions. Their professionalism, prompt communication, and deep technical expertise consistently ensure that each deployment meets our timelines and quality standards.”</p><p class="text-right font-semibold text-gray-800 mt-4">- Richard Torrez, Network Engineer V<br><span class="font-normal text-sm">Curative</span></p></div>
                    <div class="bg-[#e7f0fa] p-6 rounded-lg border-l-4 border-gray-200"><p class="text-sm text-gray-800 italic">“I am writing to recommend Layer-1 Technologies for your structured cabling needs... Layer-1 demonstrated excellent technical skills, completing the installation efficiently and flawlessly. They were also highly reliable, adhering to the project timeline and budget... I highly recommend Layer-1 Technology without reservation and plan on using them for our future needs. They are a top-notch cabling provider.”</p><p class="text-right font-semibold text-gray-800 mt-4">- JP Hale, Director of Technology<br><span class="font-normal text-sm">Hyde Park Schools</span></p></div>
                </div>
            </section>
            <section id="insurance" class="print-section-container">
                <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Insurance</h2>
                <p class="mb-4 text-gray-800">Layer-1 Technologies is fully insured for your protection and peace of mind. Our current coverage is listed below.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Commercial General Liability -->
                    <div class="bg-[#e7f0fa] p-6 rounded-lg text-center">
                        <span class="material-symbols-outlined text-[#0b5394] text-[96px]">task_alt</span>
                        <h4 class="font-bold text-[#0b5394] mt-2 mb-2">Commercial General Liability:</h4>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">Each Occurrence:</strong><br>$2,000,000</p>
                        <br>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">General Aggregate:</strong><br>$4,000,000</p>
                    </div>
                    <!-- Professional Liability -->
                    <div class="bg-[#e7f0fa] p-6 rounded-lg text-center">
                        <span class="material-symbols-outlined text-[#0b5394] text-[96px]">gpp_good</span>
                        <h4 class="font-bold text-[#0b5394] mt-2 mb-2">Professional Liability:</h4>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">Each Claim:</strong><br>$2,000,000</p>
                        <br>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">Aggregate:</strong><br>$3,000,000</p>
                    </div>
                    <!-- Automobile Liability -->
                    <div class="bg-[#e7f0fa] p-6 rounded-lg text-center">
                       <span class="material-symbols-outlined text-[#0b5394] text-[96px]">local_shipping</span>
                        <h4 class="font-bold text-[#0b5394] mt-2 mb-2">Automobile Liability:</h4>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">Combined Single Limit:</strong><br>$1,000,000</p>
                    </div>
                    <!-- Umbrella / Excess Liability -->
                    <div class="bg-[#e7f0fa] p-6 rounded-lg text-center">
                       <span class="material-symbols-outlined text-[#0b5394] text-[96px]">beach_access</span>
                        <h4 class="font-bold text-[#0b5394] mt-2 mb-2">Umbrella / Excess Liability:</h4>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">Each Occurrence:</strong><br>$5,000,000</p>
                        <br>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">Aggregate:</strong><br>$5,000,000</p>
                    </div>
                    <!-- Workers' Compensation -->
                    <div class="bg-[#e7f0fa] p-6 rounded-lg text-center">
                       <span class="material-symbols-outlined text-[#0b5394] text-[96px]">health_and_safety</span>
                        <h4 class="font-bold text-[#0b5394] mt-2 mb-2">Workers' Compensation:</h4>
                        <p class="text-sm text-gray-800"><strong class="font-semibold">Each Accident:</strong><br>$1,000,000</p>
                    </div>
                    <!-- Certificate of Insurance -->
                    <a href="https://drive.google.com/file/d/14_H2_yMVIVGAbp1yWLkm-QjwgFOyMYc1/view?usp=sharing" target="_blank" class="block bg-[#e7f0fa] p-6 rounded-lg text-center hover:shadow-lg transition-shadow flex flex-col items-center justify-center">
                        <span class="material-symbols-outlined text-[#0b5394] text-[96px]">description</span>
                        <p class="font-semibold text-[#0b5394] mt-4">Click here to view our most recent Certificate of Insurance (CoI).</p>
                    </a>
                </div>
                <div class="mt-6 space-y-3">
                     <p>Please let us know if you require being listed as an additional insured on our policy. We are happy to facilitate this request upon project agreement.</p>
                </div>
            </section>
            
            <!-- Dynamic Content Sections -->
            <section id="project-overview" class="print-section-container">
                <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Project Overview</h2>
                <div data-display="overview" class="space-y-4">
                    <p>Content for this section will be generated by the Proposal Assistant.</p>
                </div>
            </section>

            <section id="scope-of-work" class="print-section-container">
                <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Scope of Work</h2>
                <p class="mb-4">The following is a detailed description of the services and tasks to be performed for this project. This scope has been developed to address the specific needs of <span data-display="clientCompany">[CLIENT NAME]</span>.</p>
                <ul data-display="scope" class="list-disc list-outside pl-6 space-y-3 bg-[#e7f0fa] text-gray-800 p-6 rounded-lg">
                    <li>Content for this section will be generated by the Proposal Assistant.</li>
                </ul>
            </section>
            
            <section id="project-estimate" class="print-section-container">
                 <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Investment</h2>
                 <p class="mb-6">The total project investment is detailed below. Click the button to review and approve the official estimate online.</p>
                 <div class="mt-8 p-6 bg-[#e7f0fa] border-l-4 border-[#0b5394] rounded-r-lg">
                    <h4 class="font-bold text-[#0b5394]">Total Project Investment</h4>
                    <p data-display="investmentAmount" class="text-2xl font-bold text-[#094275]">[TOTAL AMOUNT FROM ESTIMATE]</p>
                    <p class="text-sm text-gray-600 mt-2">This price is valid for 30 days. Please refer to the official estimate for a complete breakdown of costs, payment schedule, and terms.</p>
                 </div>
                 <div class="text-center mt-8">
                    <a data-link="estimate" href="#" target="_blank" class="bg-[#0b5394] hover:bg-[#094275] text-white font-bold py-3 px-6 rounded-lg transition-colors text-lg inline-block shadow-md hover:shadow-lg">
                        Review & Approve Estimate Online
                    </a>
                 </div>
            </section>

            <section id="terms-of-acceptance" class="print-section-container">
                <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Terms of Acceptance</h2>
                <div class="space-y-4">
                    <p class="font-bold text-gray-800">PAYMENT TERMS:</p>
                    <ol class="list-decimal list-inside space-y-4">
                        <li><strong class="font-semibold">Project Approval & Kick-off:</strong><br> To officially begin the project, we require your formal approval. This can be provided in one of four ways:
                            <ul class="list-disc list-outside pl-6 mt-2 space-y-1">
                                <li><strong>Online:</strong> Click the "Review Estimate" button within this proposal and then click the green "Accept" button on the official estimate page. (This is the fastest method).</li>
                                <li><strong>eSignature:</strong> Electronically sign this proposal and email it back to us.</li>
                                <li><strong>Print & Sign:</strong> Print and physically sign this proposal, then email a scanned copy to us.</li>
                                <li><strong>Email Confirmation:</strong> Send an email expressly approving the project to <a href="mailto:Finance@Layer-1.com" class="text-[#0b5394] hover:underline">Finance@Layer-1.com</a>. Please reference the proposal number in your email.</li>
                            </ul>
                        </li>
                        <li><strong class="font-semibold">Deposit Requirement:</strong><br> For projects with a total investment greater than $5,000, a 50% deposit is required upon approval to secure project scheduling and cover the initial cost of materials and hardware.</li>
                        <li><strong class="font-semibold">Final Payment:</strong><br> The remaining balance will be invoiced upon project completion. All invoices are due within 30 days. If an invoice is not paid in full by the due date, a 5% late fee of the outstanding balance will be applied. An additional 5% of the new balance will be compounded for each subsequent 30-day period it remains overdue.</li>
                    </ol>
                </div>
            </section>

            <section id="acceptance" class="print-section-container">
                <h2 class="text-3xl font-bold text-[#0b5394] border-b-2 border-[#0b5394] pb-2 mb-6">Acceptance of Proposal</h2>
                <p class="mb-6">By signing below, you acknowledge that you have read, understood, and agree to the Scope of Work and the Terms of Acceptance outlined in this proposal. We look forward to partnering with you.</p>
                <div class="text-center my-8">
                    <a data-link="estimate" href="#" target="_blank" class="bg-[#0b5394] hover:bg-[#094275] text-white font-bold py-3 px-6 rounded-lg transition-colors text-lg inline-block shadow-md hover:shadow-lg">
                        Review Estimate
                    </a>
                </div>
                <div class="grid grid-cols-2 gap-12 mt-16">
                    <div><div class="border-b-2 border-gray-400 pb-2"></div><p class="mt-2 text-gray-600">Client Signature</p></div>
                    <div><div class="border-b-2 border-gray-400 pb-2"></div><p class="mt-2 text-gray-600">Date</p></div>
                </div>
            </section>
        </div>
        
        <footer class="text-center p-6 bg-gray-800 text-white text-sm no-print">
            <p>Layer-1 Technologies | Proposal <b data-display="estimateNumber">[PROPOSAL NUMBER]</b> | <span data-display="clientCompany">[CLIENT NAME]</span> | <span data-display="projectName">[PROJECT NAME]</span></p>
        </footer>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    
    /**
     * ProposalApp Module
     * Encapsulates all logic for the proposal generator to keep the global namespace clean
     * and make the code more organized and maintainable.
     */
    const ProposalApp = {
        // --- STATE ---
        // A central place to hold all the data for the application.
        state: {
            projectName: '',
            estimateNumber: '',
            clientCompany: '',
            clientContact: '',
            clientEmail: '',
            investmentAmount: '',
            estimateUrl: '',
            projectNotes: '',
        },

        // --- DOM ELEMENTS ---
        // A structured object to hold references to all necessary DOM elements.
        elements: {
            inputs: {
                projectName: document.getElementById('projectName'),
                estimateNumber: document.getElementById('estimateNumber'),
                clientCompany: document.getElementById('clientCompany'),
                clientContact: document.getElementById('clientContact'),
                clientEmail: document.getElementById('clientEmail'),
                investmentAmount: document.getElementById('investmentAmount'),
                estimateUrl: document.getElementById('estimateUrl'),
                projectNotes: document.getElementById('projectNotes'),
            },
            buttons: {
                populate: document.getElementById('populateBtn'),
                sampleData: document.getElementById('sampleDataBtn'),
                finalize: document.getElementById('finalizeBtn'),
            },
            // Using data attributes for display makes it clearer what these elements are for.
            displays: document.querySelectorAll('[data-display]'),
            links: document.querySelectorAll('[data-link="estimate"]'),
        },

        // --- METHODS ---
        
        /**
         * Initializes the application by setting up event listeners.
         */
        init() {
            this.elements.buttons.sampleData.addEventListener('click', () => this.fillWithSampleData());
            this.elements.buttons.populate.addEventListener('click', () => this.populateProposal());
            this.elements.buttons.finalize.addEventListener('click', () => window.print());
        },

        /**
         * Collects all values from the input fields and stores them in the state object.
         */
        collectInputValues() {
            for (const key in this.elements.inputs) {
                if (this.elements.inputs.hasOwnProperty(key)) {
                    this.state[key] = this.elements.inputs[key].value;
                }
            }
        },

        /**
         * Updates all display elements and links in the proposal from the state object.
         * This is a single point of truth for UI updates, making it much cleaner.
         */
        updateDisplay() {
            // Update all elements with a `data-display` attribute
            this.elements.displays.forEach(el => {
                const key = el.dataset.display;
                let value = this.state[key] || `[${key.toUpperCase()}]`;

                if (key === 'investmentAmount') {
                    const amount = parseFloat(String(this.state.investmentAmount).replace(/,/g, ''));
                    value = !isNaN(amount) 
                        ? new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount)
                        : '[TOTAL AMOUNT]';
                } else if (key === 'date') {
                    value = new Date().toLocaleDateString('en-US');
                } else if (key === 'overview' || key === 'scope') {
                    el.innerHTML = value || '<p>Generating content...</p>';
                    return; // Skip textContent assignment for HTML content
                }

                el.textContent = value;
            });

            // Update all links with a `data-link` attribute
            this.elements.links.forEach(link => {
                const url = this.state.estimateUrl;

                if (url) {
                    link.href = url;
                    link.classList.remove('opacity-50', 'cursor-not-allowed');
                    link.onclick = null;
                } else {
                    link.href = '#';
                    link.classList.add('opacity-50', 'cursor-not-allowed');
                    link.onclick = (e) => e.preventDefault();
                }
            });
            
            // Update page title
            document.title = `Layer-1 | Proposal ${this.state.estimateNumber} | ${this.state.clientCompany}`;
        },
        
        /**
         * Calls the backend API to generate proposal content.
         */
        async generateContent() {
            const { projectNotes, clientCompany, projectName } = this.state;
            const overviewEl = document.querySelector('[data-display="overview"]');
            const scopeEl = document.querySelector('[data-display="scope"]');
            
            if (!projectNotes) {
                overviewEl.innerHTML = '<p class="text-amber-600">Please enter project notes before generating.</p>';
                scopeEl.innerHTML = '<li>Please enter project notes before generating.</li>';
                return;
            }

            overviewEl.innerHTML = '<p>Generating overview... please wait.</p>';
            scopeEl.innerHTML = '<li>Generating scope... please wait.</li>';

            const prompt = `
                You are a proposal writer for Layer-1 Technologies. Based on the notes below, generate two sections of a proposal: an "Overview" and a "Scope of Work".

                **Instructions:**
                1. Deeply analyze the scope from the projectNotes.
                2. Write a professional "Project Overview" of 4-5 paragraphs, formatted as an HTML string (using <p> tags).
                3. Create a "Scope of Work" as a detailed bulleted list, formatted as an HTML string (using <li> tags). Start each list item's content with a "<strong>" tag around the main item (e.g., "<strong>Structured Cabling:</strong>").
                4. **IMPORTANT**: Return your response as a single, minified JSON object with two keys: "overview" and "scope". The value for each key should be the corresponding HTML string. Example: {"overview":"<p>...</p>","scope":"<li>...</li><li>...</li>"}

                **Client & Project Info:**
                - Client Company: ${clientCompany}
                - Project Name: ${projectName}

                **Project Notes from user:**
                ---
                ${projectNotes}
                ---`;
            
            try {
                // This relative path works on the deployed site. It may fail in some local preview environments.
                const response = await fetch('/api/generate', { 
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt }) // Send the prompt to your backend
                });

                if (!response.ok) {
                    throw new Error(`API call failed with status: ${response.status}.`);
                }
                
                const result = await response.json();
                
                // Assuming the backend forwards the Gemini response structure
                if (result.candidates && result.candidates.length > 0) {
                    const rawText = result.candidates[0].content.parts[0].text;
                    const cleanedText = rawText.replace(/^```json\n?/, '').replace(/\n?```$/, '').trim();
                    const content = JSON.parse(cleanedText);
                    
                    overviewEl.innerHTML = content.overview || '<p class="text-red-500">Error: Failed to parse overview.</p>';
                    scopeEl.innerHTML = content.scope || '<li><strong class="text-red-500">Error:</strong> Failed to parse scope.</li>';
                } else {
                     throw new Error("No content generated from API.");
                }

            } catch (error) {
                console.error('Error fetching or parsing API data:', error);
                const errorMessage = `An error occurred: ${error.message}. Check the console for details.`;
                overviewEl.innerHTML = `<p class="text-red-500">${errorMessage}</p>`;
                scopeEl.innerHTML = `<li><strong class="text-red-500">${errorMessage}</strong></li>`;
            }
        },
        
        /**
         * Main function to trigger the proposal population process.
         */
        populateProposal() {
            this.collectInputValues();
            this.updateDisplay();
            this.generateContent();
            this.showSuccess(this.elements.buttons.populate, "Analyze & Populate Proposal");
        },

        /**
         * Fills the form with sample data for testing purposes.
         */
        fillWithSampleData() {
            this.elements.inputs.projectName.value = "New Office Technology Infrastructure Setup";
            this.elements.inputs.estimateNumber.value = "21501";
            this.elements.inputs.clientCompany.value = "Innovatech Solutions";
            this.elements.inputs.clientContact.value = "Jane Doe";
            this.elements.inputs.clientEmail.value = "jane.doe@innovatech.com";
            this.elements.inputs.investmentAmount.value = "18750.00";
            this.elements.inputs.estimateUrl.value = "https://connect.intuit.com/portal/app/CommerceNetwork/view/scs-v1-875bdd9c569f4fc9a48b838a8af616421f2329d4337145cc95d84be57dbe95bdaeb462237a32414f9dc9017ed52ee4e6?locale=en_US";
            this.elements.inputs.projectNotes.value = "Full technology infrastructure build-out for a new 5,000 sq ft office space. Scope includes: 48 Cat6a network drops for workstations and VoIP phones. Installation of a new server rack in the designated IT closet, including patch panels and cable management. Setup of two conference rooms with Polycom video conferencing systems and 75-inch displays. Installation of 8 ceiling-mounted Wi-Fi 6 access points. Setup of a 10-camera security system covering all entry points and main office areas. Door access control system for the main entrance and server room using key fobs.";
            this.showSuccess(this.elements.buttons.sampleData, "Fill with Sample Data (Testing)");
        },
        
        /**
         * Provides visual feedback on a button after a successful action.
         * @param {HTMLElement} button - The button element to modify.
         * @param {string} originalText - The original text of the button.
         */
        showSuccess(button, originalText) {
            const originalClasses = button.className;
            button.textContent = '✓ Done!';
            button.className = button.className.replace(/bg-[\w-]+/, 'bg-green-500').replace(/hover:bg-[\w-]+/, 'hover:bg-green-600');
            setTimeout(() => {
                button.textContent = originalText;
                button.className = originalClasses;
            }, 2000);
        }
    };

    // Start the application
    ProposalApp.init();

});
</script>

</body>
</html>
